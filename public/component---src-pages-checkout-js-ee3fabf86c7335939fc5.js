(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{UxAK:function(e,t,n){"use strict";n.r(t);var r=n("/S4K"),a=n("kD0k"),o=n.n(a),c=n("q1tI"),l=n.n(c),s=n("oDCQ"),i=n("zPhz"),u=n("vrFN"),m=n("9E3W"),p=n("IF/j"),f=n("ma3e"),d=n("Wbzz"),y=n("xk4V"),h=n.n(y),v=n("Kvkj"),b=n("wd/R"),E=n.n(b),g=n("v4IS"),x=n("eWwy"),w="https://js.stripe.com/v3",j=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,S="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",C=null,O=function(e){return null!==C?C:C=new Promise((function(t,n){if("undefined"!=typeof window)if(window.Stripe&&e&&console.warn(S),window.Stripe)t(window.Stripe);else try{var r=function(){for(var e=document.querySelectorAll('script[src^="'.concat(w,'"]')),t=0;t<e.length;t++){var n=e[t];if(j.test(n.src))return n}return null}();r&&e?console.warn(S):r||(r=function(e){var t=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",n=document.createElement("script");n.src="".concat(w).concat(t);var r=document.head||document.body;if(!r)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return r.appendChild(n),n}(e)),r.addEventListener("load",(function(){window.Stripe?t(window.Stripe):n(new Error("Stripe.js not available"))})),r.addEventListener("error",(function(){n(new Error("Failed to load Stripe.js"))}))}catch(a){return void n(a)}else t(null)}))},k=function(e,t,n){if(null===e)return null;var r=e.apply(void 0,t);return function(e,t){e&&e._registerWrapper&&e._registerWrapper({name:"stripe-js",version:"1.13.2",startTime:t})}(r,n),r},N=Promise.resolve().then((function(){return O(null)})),P=!1;N.catch((function(e){P||console.warn(e)}));var A=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];P=!0;var r=Date.now();return N.then((function(e){return k(e,t,r)}))}("pk_test_51IRN3MAefCJ43eZzieeGe9rfdkKQCdvLdftt6SaXdpAJBHUbOANDAzG8X4l0jK1toQiqe8Fjs6nn9fdamIFpSRB400RU5MYot3");var R=function(e){var t=e.onChange,n=e.value,r=e.name,a=e.placeholder;return l.a.createElement("input",{onChange:t,value:n,className:"mt-2 text-sm shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",type:"text",placeholder:a,name:r})},_=function(e){var t=e.onChange,n=e.name,r=e.checked;return l.a.createElement("input",{type:"checkbox",onChange:t,id:n,name:n,checked:r})},I=function(e){var t=e.context,n=(e.history,Object(c.useState)(null)),a=n[0],m=n[1],y=Object(c.useState)(!1),b=y[0],w=y[1],j=Object(c.useState)(!1),S=j[0],C=j[1],O=Object(c.useState)(!1),k=O[0],N=O[1],P=Object(c.useState)(""),A=P[0],I=P[1],q=Object(c.useState)({name:"",email:"",street:"",city:"",postal_code:"",state:""}),T=q[0],B=q[1],F=Object(x.useStripe)(),D=Object(x.useElements)(),W=Object(c.useState)(!1),U=W[0],L=W[1],z=Object(c.useState)(null),M=z[0],K=z[1],Y=Object(c.useState)(""),J=Y[0],Q=Y[1],G=Object(c.useState)(!0),H=G[0],V=G[1],X=Object(c.useState)(""),$=X[0],Z=X[1],ee=function(){var e=Object(r.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.currentUserInfo();case 2:t=e.sent,I(t?t.attributes.email:"");case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(c.useEffect)((function(){console.log("SecureTrading",window.SecureTrading);var e=t.cart,n=[];Array.isArray(e)&&e.length>0&&e.forEach((function(e){return[n.push({id:e.id,quantity:e.quantity})]}));var r={body:{items:n}};s.a.post("paymentsapi","/paymentinit",r).then((function(e){e&&e.clientSecret?Z(e.clientSecret):e&&e.error?K(e.error):K("There has been an issue connecting to payment provder. Please try again later.")})),ee()}),[]);var te=function(e){var n=t.cart,r=t.clearCart,a=[];Array.isArray(n)&&n.length>0&&n.forEach((function(e){return[a.push({id:e.id,quantity:e.quantity,answer:e.answer})]}));var o={body:{order:{address:T.street+", "+T.city+", "+T.state+", "+T.postal_code,answer:a[0].answer,email:T.email,orderDate:E()(),orderProductId:a[0].id,paymentRef:e,quantity:a[0].quantity,userId:A}}};s.a.post("paymentsapi","/paymentcomplete",o).then((function(e){Q(!1),L(!0),r(),Object(d.navigate)("/complete")}))},ne=function(e){var t;m(null),B(Object.assign({},T,((t={})[e.target.name]=e.target.value,t)))},re=function(e){e.preventDefault(),C(!S)},ae=t.numberOfItemsInCart,oe=t.cart,ce=t.total,le=ae===Number(0),se=function(){var e=Object(r.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:V(t.empty),K(t.error?t.error.message:"");case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ie=function(){var e=Object(r.a)(o.a.mark((function e(n){var r,a,c,l,s,i,u,p;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),r=T.email,a=T.street,c=T.city,l=T.postal_code,s=T.state,i=t.total,F&&D){e.next=5;break}return e.abrupt("return");case 5:if(a&&c&&l&&s){e.next=8;break}return m("Please fill in the form!"),e.abrupt("return");case 8:if(k){e.next=11;break}return w(!0),e.abrupt("return");case 11:return Q(!0),e.next=14,F.confirmCardPayment($,{payment_method:{card:D.getElement(x.CardElement)}});case 14:(u=e.sent).error?(K("Payment failed "+u.error.message),Q(!1)):(K(null),p={email:r,amount:i,address:s,receipt_email:r,id:h()()},te(p.id));case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return l.a.createElement(l.a.Fragment,null,l.a.createElement(u.a,{title:"Checkout"}),l.a.createElement("div",{className:"mobile:px-10 px-4 pb-10 flex justify-center main-content"},l.a.createElement("div",{className:"w-fw"},l.a.createElement("div",{className:"flex flex-col items-center pb-10"},l.a.createElement("div",{className:" flex flex-col w-full c_large:w-c_large "},l.a.createElement("div",{className:"pt-10 pb-1"},l.a.createElement("h1",{className:"text-5xl font-light"},"Checkout"),l.a.createElement(d.Link,{to:"/cart"},l.a.createElement("div",{className:"cursor-pointer flex"},l.a.createElement(f.b,{className:"mr-2 text-gray-600 mt-1"}),l.a.createElement("p",{className:"text-gray-600 text-sm"},"Edit Cart")))),le?l.a.createElement("h3",null,"No items in cart."):l.a.createElement("div",{className:"flex flex-col lg:flex-row"},l.a.createElement("div",{className:"flex flex-1 flex-col md:flex-row"},l.a.createElement("div",{className:"flex flex-1 pt-0 flex-col"},l.a.createElement("div",{className:"mt-4 max-w-2xl"},l.a.createElement("h2",null,"Billing Details"),l.a.createElement("form",{onSubmit:ie},a?l.a.createElement("span",{className:"text-red-700"},a):"",l.a.createElement(R,{onChange:ne,value:T.name,name:"name",placeholder:"Cardholder name"}),l.a.createElement(x.CardElement,{className:"mt-2 shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",options:{style:{base:{color:"#32325d",fontFamily:"Arial, sans-serif",fontSmoothing:"antialiased",fontSize:"16px","::placeholder":{color:"#32325d"}},invalid:{color:"#fa755a",iconColor:"#fa755a"}}},onChange:se}),l.a.createElement(R,{onChange:ne,value:T.email,name:"email",placeholder:"Email"}),l.a.createElement(R,{onChange:ne,value:T.street,name:"street",placeholder:"Street"}),l.a.createElement(R,{onChange:ne,value:T.city,name:"city",placeholder:"City"}),l.a.createElement(R,{onChange:ne,value:T.state,name:"state",placeholder:"State"}),l.a.createElement(R,{onChange:ne,value:T.postal_code,name:"postal_code",placeholder:"Postal Code"})))),l.a.createElement("div",{className:"md:pt-4 flex-1"},l.a.createElement("h2",{className:"ml-4 pl-2"},"Your Order"),oe.map((function(e,t){return l.a.createElement("div",{className:"ml-4 pl-2 flex flex-1 justify-end pt-2 md:pt-8 pr-4",key:e.id},l.a.createElement("span",{className:"text-sm pr-10"},e.name),l.a.createElement("span",{className:"tracking-tighter w-24 flex justify-end"},"x",e.quantity))})),l.a.createElement("div",{className:"ml-4 pl-2 flex flex-1 justify-end pt-2 pr-4"},l.a.createElement("p",{className:"text-sm pr-10"},"Subtotal"),l.a.createElement("p",{className:"tracking-tighter w-24 flex justify-end"},Object(p.b)(ce))),l.a.createElement("div",{className:"md:ml-4 pl-2 flex flex-1 justify-end bg-gray-200 pr-4 pt-6"},l.a.createElement("p",{className:"text-sm pr-10"},"Total"),l.a.createElement("p",{className:"font-semibold tracking-tighter w-24 flex justify-end"},Object(p.b)(ce+0))),l.a.createElement(i.a,{open:S,closeOnDocumentClick:!0,onClose:function(){return C(!1)},modal:!0,contentStyle:{width:"90%",height:"67%"}},l.a.createElement("div",{className:"text-left p-4 mb-4 h-4/6 overflow-auto"},l.a.createElement("span",{role:"button",tabIndex:"0",className:"modal-close",onClick:function(){return C(!1)},onKeyDown:function(){return C(!1)}},"Ã—"),l.a.createElement(v.i,null))),l.a.createElement("div",{className:"my-3 ml-4 pl-2 text-right"},l.a.createElement(_,{name:"terms",onChange:function(e){N(e.target.checked),w(!1)},checked:k}),l.a.createElement("label",{htmlFor:"terms"}," ","I have read and agree to the website"," ",l.a.createElement("span",{role:"button",tabIndex:"0",className:"text-green-800 hover:text-gray-700 hover:underline",onClick:re,onKeyDown:re},"terms and conditions")," ","*"),b?l.a.createElement("div",{className:"text-red-700 text-sm"},"Please read and accept the terms and conditions to place your order."):null),M&&l.a.createElement("div",{className:"card-error text-red-700 flex flex-1 justify-end",role:"alert"},M),l.a.createElement("div",{className:"flex flex-1 justify-end"},l.a.createElement("button",{type:"submit",disabled:J||H||U||M,onClick:ie,className:"bg-secondary hover:bg-black text-white font-bold py-2 px-4 mt-4 rounded focus:outline-none focus:shadow-outline w-full md:w-60"},"Confirm order"))))),l.a.createElement("p",{className:U?"result-message":"result-message hidden"},"Payment succeeded, see the result in your",l.a.createElement("a",{href:"https://dashboard.stripe.com/test/payments"}," ","Stripe dashboard.")," ","Refresh the page to pay again."))))))};t.default=function(e){return l.a.createElement(m.a,null,l.a.createElement(m.b.Consumer,null,(function(t){return l.a.createElement(x.Elements,{stripe:A},l.a.createElement(I,Object.assign({},e,{context:t})))})))}},eWwy:function(e,t,n){!function(e,t){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,a=!1,o=void 0;try{for(var c,l=e[Symbol.iterator]();!(r=(c=l.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(s){a=!0,o=s}finally{try{r||null==l.return||l.return()}finally{if(a)throw o}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function c(){}function l(){}t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t,l.resetWarningCache=c;var s=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e){e.exports=function(){function e(e,t,n,r,a,o){if("SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"!==o){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:l,resetWarningCache:c};return n.PropTypes=n,n}()})),i=function(e){return null!==e&&"object"===n(e)},u=function e(t,n){if(!i(t)||!i(n))return t===n;var r=Array.isArray(t);if(r!==Array.isArray(n))return!1;var a="[object Object]"===Object.prototype.toString.call(t);if(a!==("[object Object]"===Object.prototype.toString.call(n)))return!1;if(!a&&!r)return!1;var o=Object.keys(t),c=Object.keys(n);if(o.length!==c.length)return!1;for(var l={},s=0;s<o.length;s+=1)l[o[s]]=!0;for(var u=0;u<c.length;u+=1)l[c[u]]=!0;var m=Object.keys(l);if(m.length!==o.length)return!1;var p=t,f=n;return m.every((function(t){return e(p[t],f[t])}))},m=function(e){var n=t.useRef(e);return t.useEffect((function(){n.current=e}),[e]),n.current},p=function(e){if(null===e||i(t=e)&&"function"==typeof t.elements&&"function"==typeof t.createToken&&"function"==typeof t.createPaymentMethod&&"function"==typeof t.confirmCardPayment)return e;var t;throw new Error("Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.")},f=function(e){if(function(e){return i(e)&&"function"==typeof e.then}(e))return{tag:"async",stripePromise:Promise.resolve(e).then(p)};var t=p(e);return null===t?{tag:"empty"}:{tag:"sync",stripe:t}},d=t.createContext(null);d.displayName="ElementsContext";var y=function(e){return function(e,t){if(!e)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(t," in an <Elements> provider."));return e}(t.useContext(d),e)},h=function(e){return(0,e.children)(y("mounts <ElementsConsumer>"))};h.propTypes={children:s.func.isRequired};var v=function(e){var n=t.useRef(e);return t.useEffect((function(){n.current=e}),[e]),function(){n.current&&n.current.apply(n,arguments)}},b=function(e){return i(e)?(e.paymentRequest,r(e,["paymentRequest"])):{}},E=function(){},g=function(e,n){var r,a="".concat((r=e).charAt(0).toUpperCase()+r.slice(1),"Element"),o=n?function(e){y("mounts <".concat(a,">"));var n=e.id,r=e.className;return t.createElement("div",{id:n,className:r})}:function(n){var r=n.id,o=n.className,c=n.options,l=void 0===c?{}:c,s=n.onBlur,i=void 0===s?E:s,m=n.onFocus,p=void 0===m?E:m,f=n.onReady,d=void 0===f?E:f,h=n.onChange,g=void 0===h?E:h,x=n.onEscape,w=void 0===x?E:x,j=n.onClick,S=void 0===j?E:j,C=y("mounts <".concat(a,">")).elements,O=t.useRef(null),k=t.useRef(null),N=v(d),P=v(i),A=v(p),R=v(S),_=v(g),I=v(w);t.useLayoutEffect((function(){if(null==O.current&&C&&null!=k.current){var t=C.create(e,l);O.current=t,t.mount(k.current),t.on("ready",(function(){return N(t)})),t.on("change",_),t.on("blur",P),t.on("focus",A),t.on("escape",I),t.on("click",R)}}));var q=t.useRef(l);return t.useEffect((function(){q.current&&q.current.paymentRequest!==l.paymentRequest&&console.warn("Unsupported prop change: options.paymentRequest is not a customizable property.");var e=b(l);0===Object.keys(e).length||u(e,b(q.current))||O.current&&(O.current.update(e),q.current=l)}),[l]),t.useLayoutEffect((function(){return function(){O.current&&O.current.destroy()}}),[]),t.createElement("div",{id:r,className:o,ref:k})};return o.propTypes={id:s.string,className:s.string,onChange:s.func,onBlur:s.func,onFocus:s.func,onReady:s.func,onClick:s.func,options:s.object},o.displayName=a,o.__elementType=e,o},x="undefined"==typeof window,w=g("auBankAccount",x),j=g("card",x),S=g("cardNumber",x),C=g("cardExpiry",x),O=g("cardCvc",x),k=g("fpxBank",x),N=g("iban",x),P=g("idealBank",x),A=g("p24Bank",x),R=g("epsBank",x),_=g("paymentRequestButton",x),I=g("afterpayClearpayMessage",x);e.AfterpayClearpayMessageElement=I,e.AuBankAccountElement=w,e.CardCvcElement=O,e.CardElement=j,e.CardExpiryElement=C,e.CardNumberElement=S,e.Elements=function(e){var n=e.stripe,r=e.options,o=e.children,c=t.useRef(!1),l=t.useRef(!0),s=t.useMemo((function(){return f(n)}),[n]),i=a(t.useState((function(){return{stripe:null,elements:null}})),2),p=i[0],y=i[1],h=m(n),v=m(r);return null!==h&&(h!==n&&console.warn("Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it."),u(r,v)||console.warn("Unsupported prop change on Elements: You cannot change the `options` prop after setting the `stripe` prop.")),c.current||("sync"===s.tag&&(c.current=!0,y({stripe:s.stripe,elements:s.stripe.elements(r)})),"async"===s.tag&&(c.current=!0,s.stripePromise.then((function(e){e&&l.current&&y({stripe:e,elements:e.elements(r)})})))),t.useEffect((function(){return function(){l.current=!1}}),[]),t.useEffect((function(){var e=p.stripe;e&&e._registerWrapper&&e._registerWrapper({name:"react-stripe-js",version:"1.4.0"})}),[p.stripe]),t.createElement(d.Provider,{value:p},o)},e.ElementsConsumer=h,e.EpsBankElement=R,e.FpxBankElement=k,e.IbanElement=N,e.IdealBankElement=P,e.P24BankElement=A,e.PaymentRequestButtonElement=_,e.useElements=function(){return y("calls useElements()").elements},e.useStripe=function(){return y("calls useStripe()").stripe},Object.defineProperty(e,"__esModule",{value:!0})}(t,n("q1tI"))}}]);
//# sourceMappingURL=component---src-pages-checkout-js-ee3fabf86c7335939fc5.js.map